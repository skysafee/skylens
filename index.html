<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SkyLens</title>
  <link rel="manifest" href="/manifest.json">
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="iconlensnew192.png" type="image/png">
  <meta name="theme-color" content="#0f1724" />
</head>
<body class="theme-default no-auth">

  <header class="topbar" role="banner">
    <div class="topbar-inner">
      <div class="brand" aria-label="SkyLens">
        <svg width="28" height="28" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 2L2 7v6c0 5 6 9 10 9s10-4 10-9V7L12 2z"/></svg>
        <span class="app-name">SkyLens</span>
      </div>

      <div class="top-right">
        <select id="themeSelect" class="control theme-select" aria-label="Select theme">
          <option value="default">Default</option>
          <option value="dark">Dark</option>
          <option value="ocean">Ocean</option>
          <option value="sunset">Sunset</option>
        </select>

        <button id="logoutButton" class="icon-btn" aria-label="Logout" title="Logout" type="button">
          <svg class="icon-svg" viewBox="0 0 24 24" aria-hidden="true"><path d="M16 13v-2H7V8l-5 4 5 4v-3zM20 3h-8v2h8v14h-8v2h8a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
        </button>
      </div>
    </div>
  </header>

  <div id="offlineStatus" class="offline-banner hidden" aria-hidden="true">You're offline</div>

  <div id="fullDropOverlay" class="full-drop-overlay hidden" aria-hidden="true">
    <div class="full-drop-inner" role="region" aria-label="Drop files to upload">
      <svg width="72" height="72" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 3v10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      <div class="drop-text-lg">Drop here to upload</div>
      <div class="drop-sub">Release to upload files to SkyLens</div>
    </div>
  </div>

  <main class="page" role="main">
    <noscript>
      <div style="margin:18px auto; max-width:900px; text-align:center; color:#ffdede; background:rgba(0,0,0,0.4); padding:10px; border-radius:8px;">
        SkyLens requires JavaScript. Please enable JavaScript to use the gallery.
      </div>
    </noscript>

    <section id="authSection" class="auth-wrap center-card" aria-labelledby="authTitle">
      <div class="auth-card" role="form" aria-describedby="authError">
        <h1 id="authTitle">Login to SkyLens</h1>

        <form id="loginForm" class="form">
          <div class="field">
            <label for="username" class="visually-hidden">Username</label>
            <input id="username" name="username" type="text" placeholder="Username" autocomplete="username" required />
          </div>

          <div class="field">
            <label for="password" class="visually-hidden">Password</label>
            <input id="password" name="password" type="password" placeholder="Password" autocomplete="current-password" required />
          </div>

          <div id="signupFields" class="hidden">
            <div class="field">
              <label for="confirmPassword" class="visually-hidden">Confirm password</label>
              <input id="confirmPassword" type="password" placeholder="Confirm password" autocomplete="new-password" />
            </div>
          </div>

          <div id="authError" class="form-error" aria-live="polite"></div>

          <div class="actions">
            <button id="authSubmitBtn" type="submit" class="btn primary">Continue</button>
            <button id="signupToggleBtn" type="button" class="btn ghost">Create account</button>
          </div>
        </form>
      </div>
    </section>

    <section id="gallerySection" class="gallery-wrap hidden" aria-live="polite">
      <div id="dropZone" class="dropzone hidden" aria-hidden="true">
        <div class="dropzone-inner">
          <input id="imageInput" type="file" accept="image/*" multiple class="hidden" />
          <div class="drop-text">Drag & drop images here or <button id="browseBtn" class="link" type="button">browse</button></div>
        </div>
      </div>

      <div id="gallery" class="gallery-grid" aria-live="polite" aria-label="Image gallery"></div>

      <div class="gallery-footer">
        <button id="loadMoreBtn" class="btn outline hidden" type="button">Load more</button>
        <div id="loadingSpinner" class="spinner hidden" aria-hidden="true" role="status" aria-label="Loading"></div>
      </div>
    </section>
  </main>

  <!-- LIGHTBOX -->
  <div id="lightbox" class="lightbox hidden" role="dialog" aria-modal="true" aria-label="Image viewer">
    <button class="lightbox-close icon-btn" aria-label="Close" title="Close" type="button">
      <svg class="icon-svg" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
    </button>

    <button class="lightbox-nav prev" aria-label="Previous" type="button">
      <svg class="icon-svg" viewBox="0 0 24 24"><path d="M15 6l-6 6 6 6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
    </button>

    <div class="lightbox-content">
      <!-- wrapper used by the script -->
      <div class="lightbox-image-wrap" aria-live="polite" role="region" aria-label="Image area"></div>

      <!-- actions moved to CSS; inline styles removed so CSS can fully control stacking/layout -->
      <div class="lightbox-actions">
        <button id="openNoteBtn" class="btn" aria-label="Open note" title="Note" type="button">
          <svg class="icon-svg" viewBox="0 0 24 24" aria-hidden="true"><path d="M24.98 30.009h-23v-25h14.050l2.022-1.948-0.052-0.052h-16.020c-1.105 0-2 0.896-2 2v25c0 1.105 0.895 2 2 2h23c1.105 0 2-0.895 2-2v-14.646l-2 1.909v12.736zM30.445 1.295c-0.902-0.865-1.898-1.304-2.961-1.304-1.663 0-2.876 1.074-3.206 1.403-0.468 0.462-13.724 13.699-13.724 13.699-0.104 0.106-0.18 0.235-0.219 0.38-0.359 1.326-2.159 7.218-2.176 7.277-0.093 0.302-0.010 0.631 0.213 0.851 0.159 0.16 0.373 0.245 0.591 0.245 0.086 0 0.172-0.012 0.257-0.039 0.061-0.020 6.141-1.986 7.141-2.285 0.132-0.039 0.252-0.11 0.351-0.207 0.631-0.623 12.816-12.618 13.802-13.637 1.020-1.052 1.526-2.146 1.507-3.253-0.019-1.094-0.55-2.147-1.575-3.129zM29.076 6.285c-0.556 0.574-4.914 4.88-12.952 12.798l-0.615 0.607c-0.921 0.285-3.128 0.994-4.796 1.532 0.537-1.773 1.181-3.916 1.469-4.929 1.717-1.715 13.075-13.055 13.506-13.48 0.084-0.084 0.851-0.821 1.795-0.821 0.536 0 1.053 0.244 1.577 0.748 0.627 0.602 0.95 1.179 0.959 1.72 0.010 0.556-0.308 1.171-0.943 1.827z" fill"currentColor"></svg>
        </button>

        <button id="deleteImageBtn" class="btn" aria-label="Delete image" title="Delete" type="button">
          <svg class="icon-svg" viewBox="0 0 24 24" aria-hidden="true"><path d="M13 4H8.8C7.11984 4 6.27976 4 5.63803 4.32698C5.07354 4.6146 4.6146 5.07354 4.32698 5.63803C4 6.27976 4 7.11984 4 8.8V15.2C4 16.8802 4 17.7202 4.32698 18.362C4.6146 18.9265 5.07354 19.3854 5.63803 19.673C6.27976 20 7.11984 20 8.8 20H15.2C16.8802 20 17.7202 20 18.362 19.673C18.9265 19.3854 19.3854 18.9265 19.673 18.362C20 17.7202 20 16.8802 20 15.2V11" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M4 16L8.29289 11.7071C8.68342 11.3166 9.31658 11.3166 9.70711 11.7071L13 15M13 15L15.7929 12.2071C16.1834 11.8166 16.8166 11.8166 17.2071 12.2071L20 15M13 15L15.25 17.25" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
<path d="M17 3L19 5M21 7L19 5M19 5L21 3M19 5L17 7" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
      </div>
    </div>

    <button class="lightbox-nav next" aria-label="Next" type="button">
      <svg class="icon-svg" viewBox="0 0 24 24"><path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
    </button>
  </div>

  <!-- NOTE MODAL -->
  <div id="noteModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Image note">
    <div class="modal-card">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <h3 style="margin:0">Note</h3>
        <div style="display:flex;gap:8px;align-items:center;">
          <button id="noteCloseBtn" class="icon-btn" aria-label="Close note" type="button">
            <svg class="icon-svg" viewBox="0 0 24 24"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
          </button>
        </div>
      </div>

      <div id="noteView" style="margin-top:10px;"></div>
      <textarea id="noteTextarea" class="hidden" style="margin-top:8px;"></textarea>

      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px;">
        <button id="noteEditBtn" class="btn" type="button" aria-label="Edit note">Edit</button>
        <button id="noteSaveBtn" class="btn primary hidden" type="button" aria-label="Save note">Save</button>
        <span class="note-spinner hidden" id="noteSpinner" aria-hidden="true"></span>
      </div>
    </div>
  </div>

  <!-- CAMERA MODAL (UPDATED) -->
  <div id="cameraModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Camera capture">
    <div class="camera-modal-inner">
      <div class="camera-preview-wrap" aria-live="polite">
        <video id="cameraPreview" autoplay playsinline></video>
        <div id="videoFlash" class="video-flash" aria-hidden="true"></div>
      </div>

      <!-- controls pinned to bottom, center capture -->
      <div class="camera-controls" role="toolbar" aria-label="Camera controls">
        <button id="switchCameraBtn" class="icon-btn circle" aria-label="Switch camera" title="Switch camera" type="button">
          <svg class="icon-svg" viewBox="0 0 24 24"><path d="M21 12a9 9 0 1 0-2.6 6.1" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/><path d="M21 3v6h-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
        </button>

        <button id="captureBtn" class="capture-btn" aria-label="Capture photo" title="Capture" type="button">
          <svg width="84" height="84" viewBox="0 0 84 84" aria-hidden="true">
            <circle cx="42" cy="42" r="36" stroke="#ffffff" stroke-width="4" fill="none" opacity="0.95"/>
            <circle cx="42" cy="42" r="18" fill="#ffffff" opacity="0.96"/>
          </svg>
        </button>

        <button id="closeCameraBtn" class="icon-btn circle ghost" aria-label="Close camera" title="Close" type="button">
          <svg class="icon-svg" viewBox="0 0 24 24"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </button>
      </div>
    </div>
  </div>

  <!-- FAB -->
  <div class="fab-wrap">
    <button id="fabOpen" class="fab" aria-label="Open actions" title="Upload or capture" aria-expanded="false" aria-controls="fabOptions" type="button">
      <svg class="icon-svg" viewBox="0 0 24 24"><path d="M12 5v14m7-7H5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
    </button>

    <div id="fabOptions" class="fab-options hidden" aria-hidden="true">
      <label for="imageInput" id="fabUploadLabel" class="fab-option" role="button" tabindex="0" aria-label="Upload image">
        <svg class="icon-svg" viewBox="0 0 24 24"><path d="M736.68 435.86a173.773 173.773 0 0 1 172.042 172.038c0.578 44.907-18.093 87.822-48.461 119.698-32.761 34.387-76.991 51.744-123.581 52.343-68.202 0.876-68.284 106.718 0 105.841 152.654-1.964 275.918-125.229 277.883-277.883 1.964-152.664-128.188-275.956-277.883-277.879-68.284-0.878-68.202 104.965 0 105.842zM285.262 779.307A173.773 173.773 0 0 1 113.22 607.266c-0.577-44.909 18.09-87.823 48.461-119.705 32.759-34.386 76.988-51.737 123.58-52.337 68.2-0.877 68.284-106.721 0-105.842C132.605 331.344 9.341 454.607 7.379 607.266 5.417 759.929 135.565 883.225 285.262 885.148c68.284 0.876 68.2-104.965 0-105.841z" fill="#4A5699" /><path d="M339.68 384.204a173.762 173.762 0 0 1 172.037-172.038c44.908-0.577 87.822 18.092 119.698 48.462 34.388 32.759 51.743 76.985 52.343 123.576 0.877 68.199 106.72 68.284 105.843 0-1.964-152.653-125.231-275.917-277.884-277.879-152.664-1.962-275.954 128.182-277.878 277.879-0.88 68.284 104.964 68.199 105.841 0z" fill="#C45FA0" /><path d="M545.039 473.078c16.542 16.542 16.542 43.356 0 59.896l-122.89 122.895c-16.542 16.538-43.357 16.538-59.896 0-16.542-16.546-16.542-43.362 0-59.899l122.892-122.892c16.537-16.542 43.355-16.542 59.894 0z" fill="#F39A2B" /><path d="M485.17 473.078c16.537-16.539 43.354-16.539 59.892 0l122.896 122.896c16.538 16.533 16.538 43.354 0 59.896-16.541 16.538-43.361 16.538-59.898 0L485.17 532.979c-16.547-16.543-16.547-43.359 0-59.901z" fill="#F39A2B" /><path d="M514.045 634.097c23.972 0 43.402 19.433 43.402 43.399v178.086c0 23.968-19.432 43.398-43.402 43.398-23.964 0-43.396-19.432-43.396-43.398V677.496c0.001-23.968 19.433-43.399 43.396-43.399z" fill="#E5594F" /></svg>
      </label>
      <button id="openCameraBtn" class="fab-option" aria-label="Open camera" title="Camera" type="button">
        <svg class="icon-svg" viewBox="0 0 24 24"><path d="M964.751 210.302H61.963c-25.57 0-46.296 20.727-46.296 46.296v6.518c0 25.57 20.727 46.297 46.296 46.297h902.788c25.569 0 46.297-20.727 46.297-46.297v-6.518c0-25.57-20.728-46.296-46.297-46.296z" fill="#4A5699" /><path d="M964.751 828.887H61.963c-25.57 0-46.296 20.728-46.296 46.297v6.52c0 25.565 20.727 46.297 46.296 46.297h902.788c25.569 0 46.297-20.731 46.297-46.297v-6.52c0-25.57-20.728-46.297-46.297-46.297z" fill="#C45FA0" /><path d="M68.564 210.302h-6.601c-25.57 0-46.296 20.727-46.296 46.296v625.105c0 25.565 20.727 46.297 46.296 46.297h6.601c25.571 0 46.296-20.731 46.296-46.297V256.598c0-25.57-20.725-46.296-46.296-46.296zM964.751 210.302h-6.604c-25.569 0-46.292 20.727-46.292 46.296v625.105c0 25.565 20.723 46.297 46.292 46.297h6.604c25.569 0 46.297-20.731 46.297-46.297V256.598c0-25.57-20.728-46.296-46.297-46.296z" fill="#6277BA" /><path d="M155.907 396.561a49.6 49.555 0 1 0 99.2 0 49.6 49.555 0 1 0-99.2 0Z" fill="#F0D043" /><path d="M739.108 111.191H284.412c-25.567 0-46.296 20.727-46.296 46.296v6.518c0 25.568 20.729 46.297 46.296 46.297h454.696c25.569 0 46.293-20.729 46.293-46.297v-6.518c0-25.569-20.723-46.296-46.293-46.296z" fill="#F39A2B" /><path d="M607.586 569.65c0.037 55.423-41.429 99.896-95.959 102.036-55.394 2.173-99.965-43.03-102.043-95.958-1.141-29.074-23.423-53.393-53.392-53.393-28.241 0-54.535 24.293-53.392 53.393 4.438 113.048 94.812 202.82 208.826 202.742 113.141-0.08 202.821-98.092 202.742-208.82-0.049-68.858-106.832-68.862-106.782 0z" fill="#F39A2B" /><path d="M411.073 564.357c1.049-54.399 44.634-97.98 99.036-99.029 54.426-1.049 98.01 46.207 99.028 99.029 1.326 68.771 108.109 68.9 106.783 0-2.19-113.543-92.271-203.625-205.812-205.813-113.539-2.188-203.694 95.569-205.819 205.813-1.328 68.901 105.458 68.771 106.784 0z" fill="#E5594F" /></svg>
      </button>
    </div>
  </div>

  <div id="toast" class="toast hidden" role="status" aria-live="polite" aria-atomic="true"></div>

  <script src="script.js" defer></script>
</body>
</html>

