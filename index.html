<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SkyLens</title>
  <link rel="stylesheet" href="style.css" />
  <meta name="theme-color" content="#0f1724" />
</head>
<body class="theme-default no-auth">

  <header class="topbar" role="banner">
    <div class="topbar-inner">
      <div class="brand" aria-label="SkyLens">
        <svg width="28" height="28" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 2L2 7v6c0 5 6 9 10 9s10-4 10-9V7L12 2z"/></svg>
        <span class="app-name">SkyLens</span>
      </div>

      <div class="top-right">
        <select id="themeSelect" class="control theme-select" aria-label="Select theme">
          <option value="default">Default</option>
          <option value="dark">Dark</option>
          <option value="ocean">Ocean</option>
          <option value="sunset">Sunset</option>
        </select>

        <button id="logoutButton" class="icon-btn" aria-label="Logout" title="Logout">
          <svg class="icon-svg" viewBox="0 0 24 24" aria-hidden="true"><path d="M16 13v-2H7V8l-5 4 5 4v-3zM20 3h-8v2h8v14h-8v2h8a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z"/></svg>
        </button>
      </div>
    </div>
  </header>

  <div id="offlineStatus" class="offline-banner hidden" aria-hidden="true">You're offline</div>

  <div id="fullDropOverlay" class="full-drop-overlay hidden" aria-hidden="true">
    <div class="full-drop-inner" role="region" aria-label="Drop files to upload">
      <svg width="72" height="72" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 3v10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M7 10l5 5 5-5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      <div class="drop-text-lg">Drop here to upload</div>
      <div class="drop-sub">Release to upload files to SkyLens</div>
    </div>
  </div>

  <main class="page" role="main">
    <noscript>
      <div style="margin:18px auto; max-width:900px; text-align:center; color:#ffdede; background:rgba(0,0,0,0.4); padding:10px; border-radius:8px;">
        SkyLens requires JavaScript. Please enable JavaScript to use the gallery.
      </div>
    </noscript>

    <section id="authSection" class="auth-wrap center-card" aria-labelledby="authTitle">
      <div class="auth-card" role="form" aria-describedby="authError">
        <h1 id="authTitle">Login to SkyLens</h1>

        <form id="loginForm" class="form">
          <div class="field">
            <label for="username" class="visually-hidden">Username</label>
            <input id="username" name="username" type="text" placeholder="Username" autocomplete="username" required />
          </div>

          <div class="field">
            <label for="password" class="visually-hidden">Password</label>
            <input id="password" name="password" type="password" placeholder="Password" autocomplete="current-password" required />
          </div>

          <div id="signupFields" class="hidden">
            <div class="field">
              <label for="confirmPassword" class="visually-hidden">Confirm password</label>
              <input id="confirmPassword" type="password" placeholder="Confirm password" autocomplete="new-password" />
            </div>
          </div>

          <div id="authError" class="form-error" aria-live="polite"></div>

          <div class="actions">
            <button id="authSubmitBtn" type="submit" class="btn primary">Continue</button>
            <button id="signupToggleBtn" type="button" class="btn ghost">Create account</button>
          </div>
        </form>
      </div>
    </section>

    <section id="gallerySection" class="gallery-wrap hidden" aria-live="polite">
      <div id="dropZone" class="dropzone hidden" aria-hidden="true">
        <div class="dropzone-inner">
          <input id="imageInput" type="file" accept="image/*" multiple class="hidden" />
          <div class="drop-text">Drag & drop images here or <button id="browseBtn" class="link" type="button">browse</button></div>
        </div>
      </div>

      <div id="gallery" class="gallery-grid" aria-live="polite" aria-label="Image gallery"></div>

      <div class="gallery-footer">
        <button id="loadMoreBtn" class="btn outline hidden" type="button">Load more</button>
        <div id="loadingSpinner" class="spinner hidden" aria-hidden="true" role="status" aria-label="Loading"></div>
      </div>
    </section>
  </main>

  <!-- LIGHTBOX -->
  <div id="lightbox" class="lightbox hidden" role="dialog" aria-modal="true" aria-label="Image viewer">
    <button class="lightbox-close icon-btn" aria-label="Close" title="Close">
      <svg class="icon-svg" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
    </button>

    <button class="lightbox-nav prev" aria-label="Previous">
      <svg class="icon-svg" viewBox="0 0 24 24"><path d="M15 6l-6 6 6 6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
    </button>

    <div class="lightbox-content">
      <img id="lightboxImage" src="" alt="Full image" />
      <div class="lightbox-actions" style="display:flex;gap:10px;margin-top:10px;align-items:center;">
        <button id="openNoteBtn" class="btn" aria-label="Open note" title="Note">
          <svg class="icon-svg" viewBox="0 0 24 24" aria-hidden="true"><path d="M21 15a2 2 0 0 1-2 2H8l-5 4V5a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2z" fill="currentColor"/></svg>
        </button>

        <button id="deleteImageBtn" class="btn" aria-label="Delete image" title="Delete">
          <svg class="icon-svg" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h18M8 6v12a2 2 0 0 0 2 2h4a2 2 0 0 0 2-2V6M10 11v6M14 11v6M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2" stroke="currentColor" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
        </button>
      </div>
    </div>

    <button class="lightbox-nav next" aria-label="Next">
      <svg class="icon-svg" viewBox="0 0 24 24"><path d="M9 6l6 6-6 6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
    </button>
  </div>

  <!-- NOTE MODAL -->
  <div id="noteModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Image note">
    <div class="modal-inner">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <h3 style="margin:0">Note</h3>
        <div style="display:flex;gap:8px;align-items:center;">
          <button id="noteCloseBtn" class="icon-btn" aria-label="Close note">
            <svg class="icon-svg" viewBox="0 0 24 24"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
          </button>
        </div>
      </div>

      <div id="noteView" style="margin-top:10px;"></div>
      <textarea id="noteTextarea" class="hidden" style="margin-top:8px;"></textarea>

      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:12px;">
        <button id="noteEditBtn" class="btn" type="button" aria-label="Edit note">Edit</button>
        <button id="noteSaveBtn" class="btn primary hidden" type="button" aria-label="Save note">Save</button>
        <span class="note-spinner hidden" id="noteSpinner"></span>
      </div>
    </div>
  </div>

  <!-- CAMERA MODAL (UPDATED) -->
  <div id="cameraModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-label="Camera capture">
    <div class="camera-modal-inner">
      <div class="camera-preview-wrap" aria-live="polite">
        <video id="cameraPreview" autoplay playsinline></video>
        <div id="videoFlash" class="video-flash" aria-hidden="true"></div>
      </div>

      <!-- controls pinned to bottom, center capture -->
      <div class="camera-controls" role="toolbar" aria-label="Camera controls">
        <button id="switchCameraBtn" class="icon-btn circle" aria-label="Switch camera" title="Switch camera">
          <!-- redo / rotate camera SVG -->
          <svg class="icon-svg" viewBox="0 0 24 24"><path d="M21 12a9 9 0 1 0-2.6 6.1" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/><path d="M21 3v6h-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
        </button>

        <button id="captureBtn" class="capture-btn" aria-label="Capture photo" title="Capture">
          <!-- SVG ring + inner circle -->
          <svg width="84" height="84" viewBox="0 0 84 84" aria-hidden="true">
            <circle cx="42" cy="42" r="36" stroke="#ffffff" stroke-width="4" fill="none" opacity="0.95"/>
            <circle cx="42" cy="42" r="18" fill="#ffffff" opacity="0.96"/>
          </svg>
        </button>

        <button id="closeCameraBtn" class="icon-btn circle ghost" aria-label="Close camera" title="Close">
          <svg class="icon-svg" viewBox="0 0 24 24"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
        </button>
      </div>
    </div>
  </div>

  <!-- FAB -->
  <div class="fab-wrap">
    <button id="fabOpen" class="fab" aria-label="Open actions" title="Upload or capture">
      <svg class="icon-svg" viewBox="0 0 24 24"><path d="M12 5v14m7-7H5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/></svg>
    </button>

    <div id="fabOptions" class="fab-options hidden" aria-hidden="true">
      <label for="imageInput" id="fabUploadLabel" class="fab-option" role="button" tabindex="0" aria-label="Upload image">
        <svg class="icon-svg" viewBox="0 0 24 24"><path d="M12 3v10" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/></svg>
      </label>
      <button id="openCameraBtn" class="fab-option" aria-label="Open camera" title="Camera">
        <svg class="icon-svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 1 0 0 10 5 5 0 0 0 0-10zm7-2h-3.2l-1.1-1.6A1 1 0 0 0 13.8 3H10.2a1 1 0 0 0-.9.4L8.2 5H5a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2z" fill="currentColor"/></svg>
      </button>
    </div>
  </div>

  <div id="toast" class="toast hidden" role="status" aria-live="polite" aria-atomic="true"></div>

  <script src="script.js" defer></script>
</body>
</html>
